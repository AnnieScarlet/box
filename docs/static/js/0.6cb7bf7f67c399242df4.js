webpackJsonp([0],{"3/Wh":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("ragk"),n=r.n(i);for(var a in i)"default"!==a&&function(t){r.d(e,t,function(){return i[t]})}(a);var u=r("XUdU"),c=function(t){r("rJxJ")},s=r("VU/8")(n.a,u.a,!1,c,null,null);e.default=s.exports},BO1k:function(t,e,r){t.exports={default:r("fxRn"),__esModule:!0}},DaOP:function(t,e){},XUdU:function(t,e,r){"use strict";var i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"upload"}},[t._v("\n  Upload\n  "),t._l(t.files,function(t){return r("Uploader",{key:t.name,attrs:{file:t}})}),t._v(" "),r("input",{attrs:{type:"file",value:"Drop files here",multiple:""},on:{change:function(e){t.handleFileSelect(e)},dragover:function(e){t.handleDragOver(e)},drop:function(e){t.handleFileSelect(e)}}})],2)},staticRenderFns:[]};e.a=i},dnkX:function(t,e,r){"use strict";var i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.thumb_url?r("form",{on:{submit:function(e){e.preventDefault(),t.submit(e)}}},[r("div",[r("div",{staticClass:"thumbnail"},[r("CanvasWrapper",{attrs:{url:t.thumb_url,width:t.width,height:t.height,updateRect:t.updateRect}}),t._v(" "),r("Thumbnail",{attrs:{url:t.thumb_url,rect:t.thumb_rect}})],1)]),t._v(" "),r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",name:"title",placeholder:"title"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),r("div",[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],attrs:{name:"description",placeholder:"description"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})]),t._v(" "),r("button",{attrs:{type:"submit"}},[t._v("Submit")])]):t._e()},staticRenderFns:[]};e.a=i},fxRn:function(t,e,r){r("+tPU"),r("zQR9"),t.exports=r("g8Ux")},g8Ux:function(t,e,r){var i=r("77Pl"),n=r("3fs2");t.exports=r("FeBl").getIterator=function(t){var e=n(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},mXEl:function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(r("//Fk")),a=i(r("Xxa5")),u=i(r("exGp")),c=i(r("oiih")),s=i(r("gyMJ")),h=i(r("UDkx"));HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,r){for(var i=atob((void 0).toDataURL(e,r).split(",")[1]),n=i.length,a=new Uint8Array(n),u=0;u<n;u++)a[u]=i.charCodeAt(u);t(new Blob([a],{type:e||"image/png"}))}});var o={template:'<canvas v-bind:width="width" v-bind:height="height" v-bind:style="styleObject" v-on:mousedown="onMouseDown($event)" v-on:mouseup="onMouseUp($event)" v-on:mousemove="onMouseMove($event)"></canvas>',props:["url","width","height","updateRect"],computed:{styleObject:function(){return{backgroundImage:"url("+this.url+")",backgroundSize:"100%"}}},mounted:function(){this._ctx=this.$el.getContext("2d"),this._ctx.fillStyle="rgba(0, 0, 0, 0.4)",this._ctx.strokeStyle="red";var t={x:parseInt((this.width-c.default.THUMBNAIL_BOX_SIZE.WIDTH)/2),y:parseInt((this.height-c.default.THUMBNAIL_BOX_SIZE.HEIGHT)/2)};this._begin_point={x:0,y:0},this._current_rect={min:{x:t.x,y:t.y},max:{x:t.x+c.default.THUMBNAIL_BOX_SIZE.WIDTH,y:t.y+c.default.THUMBNAIL_BOX_SIZE.HEIGHT}},this.draw()},methods:{getRect:function(){return{min:{x:this._current_rect.min.x/this.width,y:this._current_rect.min.y/this.height},max:{x:this._current_rect.max.x/this.width,y:this._current_rect.max.y/this.height}}},getPoint:function(t){return{x:window.pageXOffset+t.clientX-this.$el.offsetLeft,y:window.pageYOffset+t.clientY-this.$el.offsetTop}},resolveRect:function(){this._current_rect.min.x<0&&(this._current_rect.max.x-=this._current_rect.min.x,this._current_rect.min.x=0),this._current_rect.min.y<0&&(this._current_rect.max.y-=this._current_rect.min.y,this._current_rect.min.y=0),this._current_rect.max.x>this.width&&(this._current_rect.min.x-=this._current_rect.max.x-this.width,this._current_rect.max.x=this.width),this._current_rect.max.y>this.height&&(this._current_rect.min.y-=this._current_rect.max.y-this.height,this._current_rect.max.y=this.height)},setScale:function(t){this.width*t<c.default.THUMBNAIL_BOX_SIZE.WIDTH&&(t=c.default.THUMBNAIL_BOX_SIZE.WIDTH/this.width),this.height*t<c.default.THUMBNAIL_BOX_SIZE.HEIGHT&&(t=c.default.THUMBNAIL_BOX_SIZE.HEIGHT/this.height);var e=this._current_rect.max.x-this._current_rect.min.x,r=this._current_rect.max.y-this._current_rect.min.y,i=this._current_rect.min.x+e/2,n=this._current_rect.min.y+r/2,a=c.default.THUMBNAIL_BOX_SIZE.WIDTH*(1/t)/2,u=c.default.THUMBNAIL_BOX_SIZE.HEIGHT*(1/t)/2;this._current_rect={min:{x:i-a,y:n-u},max:{x:i+a,y:n+u}},this.resolveRect()},onMouseDown:function(t){if(!this._dragging){var e=this.getPoint(t),r=e.x,i=e.y;this._current_rect.min.x<=r&&r<=this._current_rect.max.x&&this._current_rect.min.y<=i&&i<=this._current_rect.max.y&&(this._dragging=!0,this._begin_point={x:r-this._current_rect.min.x,y:i-this._current_rect.min.y})}},onMouseUp:function(t){this._dragging=!1},onMouseMove:function(t){if(this._dragging){var e=this.getPoint(t),r=e.x,i=e.y,n={x:r-this._begin_point.x,y:i-this._begin_point.y};this._current_rect={min:n,max:{x:this._current_rect.max.x-(this._current_rect.min.x-n.x),y:this._current_rect.max.y-(this._current_rect.min.y-n.y)}},this._current_rect.min.x<0&&(this._begin_point.x=r),this._current_rect.max.x>this.width&&(this._begin_point.x=r-(this.width-(this._current_rect.max.x-this._current_rect.min.x))),this._current_rect.min.y<0&&(this._begin_point.y=i),this._current_rect.max.y>this.height&&(this._begin_point.y=i-(this.height-(this._current_rect.max.y-this._current_rect.min.y))),this.resolveRect(),this.draw()}},draw:function(){this._ctx.clearRect(0,0,this.width,this.height),this._ctx.fillRect(0,0,this.width,this.height),this._ctx.clearRect(this._current_rect.min.x,this._current_rect.min.y,this._current_rect.max.x-this._current_rect.min.x,this._current_rect.max.y-this._current_rect.min.y),this._ctx.strokeRect(this._current_rect.min.x,this._current_rect.min.y,this._current_rect.max.x-this._current_rect.min.x,this._current_rect.max.y-this._current_rect.min.y),this.updateRect(this.getRect())}}};e.default={components:{Thumbnail:h.default,CanvasWrapper:o},props:["file"],data:function(){return{width:0,height:0,thumb_url:null,thumb_rect:null,title:null,description:null}},mounted:function(){var t=this;this.reset();var e=this,r=new FileReader;r.readAsDataURL(this.file),r.onload=(0,u.default)(a.default.mark(function i(){var n;return a.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:(n=new Image).src=r.result,n.onload=(0,u.default)(a.default.mark(function r(){var i,u,s;return a.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.resolveSize(n.width,n.height,c.default.THUMBNAIL_MAX_SIZE,c.default.THUMBNAIL_MAX_SIZE),u=i.width,s=i.height,e.width=u,e.height=s,r.next=5,t.resize(n,c.default.IMAGE_MAX_SIZE);case 5:e._img_data=r.sent,e._img_url=URL.createObjectURL(e._img_data),e.thumb_url=e._img_url;case 8:case"end":return r.stop()}},r,t)}));case 3:case"end":return i.stop()}},i,t)}))},methods:{updateRect:function(t){this.thumb_rect=t},reset:function(){this._img_data=null,this._img_url&&URL.revokeObjectURL(this._img_url)},resolveSize:function(t,e,r,i){var n=function(r,i){var n=i(r(t,e));t*=n,e*=n};return r&&n(Math.max,function(t){return t>r?r/t:1}),i&&n(Math.min,function(t){return t<i?i/t:1}),{width:t,height:e}},resize:function(t,e,r){var i=this;return(0,u.default)(a.default.mark(function u(){var s,h,o,_;return a.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=i.resolveSize(t.width,t.height,e),h=s.width,o=s.height,r=r||document.createElement("canvas"),_=r.getContext("2d"),r.width=h,r.height=o,_.drawImage(t,0,0,h,o),a.abrupt("return",new n.default(function(t,e){r.toBlob(t,"image/jpeg",c.default.IMAGE_QUALITY)}));case 7:case"end":return a.stop()}},u,i)}))()},submit:function(t){var e=new FormData;e.append("title",this.title),e.append("description",this.description),e.append("file",this._img_data),s.default.postMediaData(e)}},destroyed:function(){this.reset()}}},rJxJ:function(t,e){},ragk:function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(r("BO1k")),a=i(r("uHkJ"));e.default={components:{Uploader:a.default},data:function(){return{files:[]}},methods:{handleFileSelect:function(t){t.stopPropagation(),t.preventDefault();var e=!0,r=!1,i=void 0;try{for(var a,u=(0,n.default)((t.dataTransfer||t.target).files);!(e=(a=u.next()).done);e=!0){var c=a.value;0===c.type.indexOf("image/")&&this.files.push(c)}}catch(t){r=!0,i=t}finally{try{!e&&u.return&&u.return()}finally{if(r)throw i}}},handleDragOver:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}}}},uHkJ:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("mXEl"),n=r.n(i);for(var a in i)"default"!==a&&function(t){r.d(e,t,function(){return i[t]})}(a);var u=r("dnkX"),c=function(t){r("DaOP")},s=r("VU/8")(n.a,u.a,!1,c,null,null);e.default=s.exports}});
//# sourceMappingURL=0.6cb7bf7f67c399242df4.js.map